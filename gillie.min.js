/*!
* Gillie JavaScript Library 0.2.1
* http://pablovallejo.github.io/gillie
*/
!function(a,b){var c=!1,d=/xyz/.test(function(){})?/\b_super\b/:/.*/,e=function(){},f=function(b){return a.each([].slice.call(arguments,1),function(a,c){if(c)for(var d in c)b[d]=c[d]}),b},g=e.Events={on:function(a,b,c){if(!i(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},trigger:function(a){if(!this._events)return this;var b=[].slice.call(arguments,1);if(!i(this,"trigger",a,b))return this;var c=this._events[a];return c&&j(c,b),this}},h=/\s+/,i=function(a,b,c,d){if(c){if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(h.test(c)){for(var f=c.split(h),g=0,i=f.length;i>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0}},j=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},k={on:"listenTo"};a.each(k,function(a,b){g[b]=function(b,c,d){var e=this._listeners||(this._listeners={}),f=b._listenerId||(b._listenerId=w("l"));return e[f]=b,"object"==typeof c&&(d=this),b[a](c,d,this),this}});var l=e.Handler=function(){this.initialize&&this.initialize.apply(this,arguments),this.delegateEvents()},m=/^(\S+)\s*(.*)$/;f(l.prototype,g,{bind:function(a,b){return function(){return a.apply(b,arguments)}},delegateEvents:function(b){if(!b&&!(b=this.events))return this;for(var c in b){var d=b[c];if(d=this[b[c]]){var e=c.match(m),f=e[1],g=e[2],h=this.el||document;d=this.bind(d,this),""===g?a(h).on(f,d):a(h).on(f,g,d)}}return this}});var n=e.Model=function(b){var c,d=b||{};this.cid=w("c"),this.attributes={},(c=this.defaults)&&(d=a.extend({},c,d)),this.attributes=d,this.initialize&&this.initialize()},o=/(\(\?)?:\w+/g;f(n.prototype,g,{set:function(a,b,c){var d,e,f,g;if(null==a)return this;"object"==typeof a?(e=a,c=b):(e={})[a]=b,c||(c={}),g=c.unset,f=this.attributes;for(d in e)b=e[d],g?delete f[d]:f[d]=b;return this},get:function(a){return this.attributes[a]},unset:function(a,b){return this.set(a,void 0,f({},b,{unset:!0}))},toJSON:function(){return a.extend({},this.attributes)},buildRequestUrl:function(a){var c,d,a,e=this;return a=a.replace(o,function(a,b){return c=a.replace(":",""),d=e.get(c),b?a:d||a}),/^(\/\/|http:|https:).*/.test(a)?a:this.url?this.url+a:b.location.href+"/"+a},sync:function(){return e.sync.apply(this,arguments)}});var p=[["Get","read"],["Post","create"],["Put","update"],["Delete","delete"],["Patch","patch"]],q={};a.each(p,function(a,b){q[b[0]]=function(a,c,d){d=d?d:{};var e,f=this,g=d.success;return d.success=function(a){g&&g(f,a,d),f.trigger(c,f,a,d)},d.url=this.buildRequestUrl(a),e=this.sync(b[1],this,d)}}),f(n.prototype,q);var r=e.View=function(){this.initialize&&this.initialize()};f(r.prototype,g),e.sync=function(b,c,d){var f=t[b],g={type:f,dataType:"json"};d.url||(g.url=c.url),null!=d.data||!c||"create"!==b&&"update"!==b&&"patch"!==b||(g.contentType="application/json",g.data=JSON.stringify(d.attrs||c.toJSON())),"GET"!==g.type&&(g.processData=!1),"PATCH"===g.type&&s&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var h=d.xhr=e.ajax(a.extend(g,d));return c.trigger("request",c,h,d),h};var s=!("undefined"==typeof b||!b.ActiveXObject||b.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),t={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return a.ajax.apply(a,arguments)};var u=function(a){function b(){c||f.apply(this,arguments)}var e=this.prototype,f=this;c=!0;var g=new this;c=!1;for(var h in a)g[h]="function"==typeof a[h]&&"function"==typeof e[h]&&d.test(a[h])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(h,a[h]):a[h];return b.prototype=g,b.prototype.constructor=b,b.extend=arguments.callee,b},v=0,w=function(a){var b=++v+"";return a?a+b:b};e.Handler.extend=e.Model.extend=e.View.extend=u,b.Gillie=e}(jQuery,this);
